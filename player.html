<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Devansh X Anuj Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Basic Styling -->
<style>
    body {
        margin: 0;
        background: #0d0d0d;
        font-family: Arial, sans-serif;
        color: white;
        text-align: center;
    }

    h2 {
        margin: 15px;
        font-size: 26px;
        font-weight: bold;
        color: #00eaff;
        text-shadow: 0px 0px 10px #00eaff;
    }

    .player-container {
        width: 100%;
        max-width: 900px;
        margin: auto;
        padding: 10px;
    }

    video {
        width: 100%;
        border-radius: 12px;
        background: black;
        box-shadow: 0px 0px 20px rgba(0,255,255,0.4);
    }

    .controls {
        background: rgba(255,255,255,0.1);
        padding: 12px;
        margin-top: 10px;
        border-radius: 10px;
        display: flex;
        justify-content: space-around;
        backdrop-filter: blur(10px);
    }

    select {
        padding: 6px 10px;
        border-radius: 6px;
        border: none;
        font-size: 14px;
    }

</style>

<!-- HLS Library -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

</head>
<body>

<h2>Devansh X Anuj</h2>

<div class="player-container">
    <video id="videoPlayer" controls></video>

    <div class="controls">

        <!-- Speed Control -->
        <select id="speedControl">
            <option value="0.25">0.25x</option>
            <option value="0.5">0.5x</option>
            <option value="1" selected>1x (Normal)</option>
            <option value="1.5">1.5x</option>
            <option value="2">2x</option>
            <option value="2.5">2.5x</option>
            <option value="3">3x</option>
            <option value="4">4x</option>
        </select>

        <!-- Quality Control -->
        <select id="qualityControl">
            <option value="auto" selected>Auto Quality</option>
            <option value="144">144p</option>
            <option value="240">240p</option>
            <option value="360">360p</option>
            <option value="480">480p</option>
            <option value="720">720p</option>
            <option value="1080">1080p</option>
        </select>

    </div>
</div>

<script>

// Detect URL parameter automatically
function getVideoURL() {
    const params = new URLSearchParams(window.location.search);
    const keys = ["url", "Url", "URL", "video", "Video", "VIDEO", "u", "U"];
    for (const key of keys) {
        if (params.has(key)) return params.get(key);
    }
    return null;
}

const videoURL = getVideoURL();
const video = document.getElementById("videoPlayer");

if (!videoURL) {
    alert("Error: No video URL found! Use ?url=YOUR_M3U8_LINK");
} else {

    // Play video using HLS.js
    if (Hls.isSupported()) {
        window.hls = new Hls({ maxMaxBufferLength: 60 });
        hls.loadSource(videoURL);
        hls.attachMedia(video);

        // Quality selector
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
            const levels = hls.levels;
            const qSelect = document.getElementById("qualityControl");

            qSelect.onchange = () => {
                const q = qSelect.value;
                if (q === "auto") {
                    hls.currentLevel = -1;
                } else {
                    let levelIndex = levels.findIndex(l => l.height == q);
                    hls.currentLevel = levelIndex;
                }
            };
        });

    } else {
        video.src = videoURL;
    }
}

// Speed Control
document.getElementById("speedControl").onchange = function () {
    video.playbackRate = this.value;
};

</script>

</body>
</html>